"use strict";(self.webpackChunkbuild_iq_app=self.webpackChunkbuild_iq_app||[]).push([[798],{798:function(e,t,n){n.d(t,{h:function(){return E},Z:function(){return W}});var r=n(969),a=n(3026),o=n(3668),i=n(6234),c=n(7765),u=n(8224),l=n(3127),s=n(9530),d=n(8368),m=n(8079),p=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},y="/transaction/purchase/order/",f=d.hi.injectEndpoints({overrideExisting:!1,endpoints:function(e){return{listTransaction:e.query({query:function(e){var t=e.page,n=e.size;return{url:(0,d.DS)(y,"?page=".concat(t||1,"&page_size=").concat(n||d.IV))}},providesTags:function(e){var t;return e?[].concat((0,m.Z)(null===(t=null===e||void 0===e?void 0:e.results)||void 0===t?void 0:t.map((function(e){var t=e.key;return{type:d.pJ.TRANSACTION,key:t}}))),[{type:d.pJ.TRANSACTION,id:"LIST"}]):[{type:d.pJ.TRANSACTION,id:"LIST"}]}}),addTransaction:e.mutation({query:function(e){return{url:y,method:"POST",body:e}},invalidatesTags:[{type:d.pJ.TRANSACTION,id:"LIST"}]}),getTransaction:e.query({query:function(e){return"".concat(y).concat(e)},providesTags:function(e,t,n){return[{type:d.pJ.TRANSACTION,id:n}]}}),updateTransaction:e.mutation({query:function(e){var t=e.key,n=p(e,["key"]);return{url:"".concat(y).concat(t),method:"PUT",body:n}},invalidatesTags:function(e){return[{type:d.pJ.TRANSACTION,id:null===e||void 0===e?void 0:e.key}]}}),deleteTransaction:e.mutation({query:function(e){return{url:"".concat(y).concat(e),method:"DELETE"}},invalidatesTags:function(e){return[{type:d.pJ.TRANSACTION,id:null===e||void 0===e?void 0:e.id}]}}),getStates:e.query({query:function(){return{url:(0,d.DS)("/geo/state/")}},providesTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat((0,m.Z)(e.map((function(e){return{type:"States",id:e.state_key}}))),[{type:"States",id:"LIST"}])}}),getCities:e.query({query:function(e){return{url:(0,d.DS)("/geo/city/?state=".concat(e))}},providesTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat((0,m.Z)(e.map((function(e){return{type:"Cities",id:e.city_key}}))),[{type:"Cities",id:"LIST"}])}}),getErrorProne:e.query({query:function(){return"error-prone"}})}}}),T=f.useAddTransactionMutation,v=f.useDeleteTransactionMutation,g=f.useGetTransactionQuery,h=f.useListTransactionQuery,b=f.useUpdateTransactionMutation,E=(f.useGetErrorProneQuery,f.useGetStatesQuery,f.useGetCitiesQuery,f.endpoints.getTransaction,"materialpurchase"),S="Material Purchase",I=n(6770),N=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},A="/transaction/purchase/order/items/",O=d.hi.injectEndpoints({overrideExisting:!1,endpoints:function(e){return{listTransactionItem:e.query({query:function(e){var t=e.page,n=e.size;return{url:(0,d.DS)(A,"?page=".concat(t||1,"&page_size=").concat(n||d.IV))}},providesTags:function(e){var t;return e?[].concat((0,m.Z)(null===(t=null===e||void 0===e?void 0:e.results)||void 0===t?void 0:t.map((function(e){var t=e.item_key;return{type:d.pJ.TRANSACTION_ITEM,item_key:t}}))),[{type:d.pJ.TRANSACTION_ITEM,id:"LIST"}]):[{type:d.pJ.TRANSACTION_ITEM,id:"LIST"}]}}),addTransactionItem:e.mutation({query:function(e){return{url:A,method:"POST",body:e}},invalidatesTags:[{type:d.pJ.TRANSACTION_ITEM,id:"LIST"}]}),getTransactionItem:e.query({query:function(e){return"".concat(A).concat(e)},providesTags:function(e,t,n){return[{type:d.pJ.TRANSACTION_ITEM,id:n}]}}),updateTransactionItem:e.mutation({query:function(e){var t=e.item_key,n=N(e,["item_key"]);return{url:"".concat(A).concat(t),method:"PUT",body:n}},invalidatesTags:function(e){return[{type:d.pJ.TRANSACTION_ITEM,id:null===e||void 0===e?void 0:e.item_key}]}}),deleteTransactionItem:e.mutation({query:function(e){return{url:"".concat(A).concat(e),method:"DELETE"}},invalidatesTags:function(e){return[{type:d.pJ.TRANSACTION_ITEM,id:null===e||void 0===e?void 0:e.id}]}}),getStates:e.query({query:function(){return{url:(0,d.DS)("/geo/state/")}},providesTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat((0,m.Z)(e.map((function(e){return{type:"States",id:e.state_key}}))),[{type:"States",id:"LIST"}])}}),getCities:e.query({query:function(e){return{url:(0,d.DS)("/geo/city/?state=".concat(e))}},providesTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat((0,m.Z)(e.map((function(e){return{type:"Cities",id:e.city_key}}))),[{type:"Cities",id:"LIST"}])}}),getErrorProne:e.query({query:function(){return"error-prone"}})}}}),L=(O.useAddTransactionItemMutation,O.useDeleteTransactionItemMutation),P=(O.useGetTransactionItemQuery,O.useListTransactionItemQuery),R=(O.useUpdateTransactionItemMutation,O.useGetErrorProneQuery,O.useGetStatesQuery,O.useGetCitiesQuery,O.endpoints.getTransactionItem,function(e){var t=e.moduleName,n=(0,r.useState)([]),a=(0,i.Z)(n,2),o=a[0],c=a[1],u=P({}),l=u.data,d=u.isLoading,m=L(),p=(0,i.Z)(m,2),y=p[0],f=p[1].isLoading,T=(0,r.useRef)(o);(0,r.useEffect)((function(){c((null===l||void 0===l?void 0:l.results)||[])}),[l]);var v=function(e){return r.createElement(s.JK,{value:e||0})};return r.createElement(s.PS,{baseRoute:"/".concat(t,"/").concat(E),description:S,isLoading:d||f,data:o,newTable:!0,tableLayoutClass:"h-full",allowFilters:!1,deleteAction:function(e){return y(e).unwrap()},actionBodyTemplate:function(e){return r.createElement(I.z,{style:{height:"35px",width:"20px",marginLeft:20},type:"button",onClick:function(){return function(e){console.log("items",e,T.current);var t=T.current.filter((function(t){return t!==e}));T.current=t,c(t)}(e)},className:"p-button-rounded p-button-text",icon:"pi pi-trash"})},gridProps:{allowAdd:!0,newRowDefaults:{netamt:0,taxamt:0,totalamt:0},OnRowsChanged:function(e){c(e),T.current=e},getBottomSummaryRows:function(e){return[{netamt:e.map((function(e){return e.netamt})).reduce((function(e,t){return e+t}),0),taxamt:e.map((function(e){return e.taxamt})).reduce((function(e,t){return e+t}),0),totalamt:e.map((function(e){return e.totalamt})).reduce((function(e,t){return e+t}),0)}]}}},r.createElement(s._P,{field:"item",header:"Item",editorType:"text"}),r.createElement(s._P,{field:"uom",header:"UOM",editorType:"text"}),r.createElement(s._P,{field:"quantiy",header:"Quantiy",type:"number",editorType:"number"}),r.createElement(s._P,{field:"unitprice",header:"Unit Price",type:"number",editorType:"number"}),r.createElement(s._P,{field:"netamt",header:"Net Amt",type:"currency",defaultValue:0,editorType:"currency",summaryFormatter:function(e){var t=e.row;return v(null===t||void 0===t?void 0:t.netamt)}}),r.createElement(s._P,{field:"taxamt",header:"Tax Amt",type:"currency",defaultValue:0,editorType:"currency",summaryFormatter:function(e){var t=e.row;return v(null===t||void 0===t?void 0:t.taxamt)}}),r.createElement(s._P,{field:"totalamt",header:"Total Amt",type:"currency",defaultValue:0,editorType:"currency",summaryFormatter:function(e){var t=e.row;return v(null===t||void 0===t?void 0:t.totalamt)}}))});var w=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(t){o(t)}}function c(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},_={client_id:"1001",company:"TEST"},x=function(e){var t=e.moduleName,n=(0,s.pm)(),m=n.showSuccess,p=n.showError,y=(0,r.useState)(!1),f=(0,i.Z)(y,2),v=f[0],h=f[1],I=(0,a.UO)().id,N=parseInt(I||""),A=isNaN(N)||N<=0,O=g(N,{skip:A}),L=O.data,P=O.isLoading,x=(0,a.s0)(),k=(0,d.JB)(),q=k.data,C=k.isLoading,W=(0,d.Wv)(),j=W.data,D=W.isLoading,J=b(),M=(0,i.Z)(J,2),Z=M[0],G=M[1].isLoading,V=T(),Q=(0,i.Z)(V,2),F=Q[0],U=Q[1].isLoading,z=function(e,t){return e?t?"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()):new Date(e):e};return r.createElement(r.Fragment,null,r.createElement(s.Rm,{baseRoute:"/".concat(t,"/").concat(E),description:S,id:N,data:L,moreSubmitItems:r.createElement(r.Fragment,null),isUpdating:U||G||v,isLoading:P,onSubmit:function(e){return w(void 0,void 0,void 0,(0,o.Z)().mark((function n(){var r;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("submit",e),n.prev=1,!A){n.next=8;break}return n.next=5,F(Object.assign(Object.assign({},e),_)).unwrap();case 5:r=n.sent,n.next=11;break;case 8:return n.next=10,Z(Object.assign(Object.assign({},e),_)).unwrap();case 10:r=n.sent;case 11:m("Success",r.detail),h(!0),setTimeout((function(){x("/".concat(t,"/").concat(E))}),3e3),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(1),p("An error occurred","We couldn't save your post, try again!");case 19:case"end":return n.stop()}}),n,null,[[1,16]])})))},renderForm:function(e,n,a){return r.createElement("div",{className:"pl-4 pt-4 grid p-fluid h-full"},r.createElement("div",{className:"col-12 md:col-6 grid grid-nogutter p-fluid",style:{alignContent:"flex-start"}},r.createElement(s.Wi,{label:"Doc ID",name:"docid",className:"col-12 md:col-6",control:e,errors:a,formItem:{component:c.o,componentProps:{disabled:!0}}}),r.createElement(s.Wi,{label:"Type",name:"loctyp",className:"col-12 md:col-6",centerText:!0,control:e,errors:a,formItem:{component:u.L,componentProps:{optionLabel:"name",optionValue:"id",options:[{name:"Project",id:"PR"},{name:"Warehouse",id:"WH"}]}}})),r.createElement(s.Wi,{label:"GRN Number",name:"number",className:"col-12 md:col-6",control:e,errors:a,formItem:{component:c.o}}),r.createElement(s.Wi,{label:"Project",name:"proj_key",className:"col-12 md:col-6",control:e,errors:a,isLoading:C,leftSpan:3,rightSpan:9,formItem:{component:u.L,componentProps:{optionLabel:"name",optionValue:"key",filter:!0,filterBy:"name",options:null===q||void 0===q?void 0:q.data}}}),r.createElement(s.Wi,{label:"GRN Date",name:"date",className:"col-12 md:col-6",useExplicit:!0,control:e,errors:a,convertValue:z,formItem:{component:l.f,componentProps:{showIcon:!0,dateFormat:"yy-mm-dd"}}}),r.createElement(s.Wi,{label:"Vendor",name:"vend_key",className:"col-12 md:col-6",control:e,errors:a,isLoading:D,leftSpan:3,rightSpan:9,formItem:{component:u.L,componentProps:{optionLabel:"name",optionValue:"key",filter:!0,filterBy:"name",options:null===j||void 0===j?void 0:j.data}}}),r.createElement(s.Wi,{label:"Vendor RefNo",name:"vendor_refno",className:"col-12 md:col-6",control:e,errors:a,formItem:{component:c.o}}),r.createElement("div",{className:"col-12 ",style:{height:"calc(100% - 183px)"}},r.createElement(R,{moduleName:t})))}}))},k=n(4401),q=n(7624),C=function(e){var t=e.moduleName,n=h({}),a=n.data,o=n.isLoading,c=v(),u=(0,i.Z)(c,2),l=u[0],d=u[1].isLoading;return r.createElement(s.PS,{baseRoute:"/".concat(t,"/").concat(E),description:S,isLoading:o||d,newTable:!0,showHeader:!0,data:null===a||void 0===a?void 0:a.results,deleteAction:function(e){return l(e).unwrap()}},r.createElement(k.s,{headerStyle:q.iR,field:"number",header:"GRN Number",sortable:!0,filter:!0,style:{minWidth:"8rem"}}),r.createElement(k.s,{headerStyle:q.iR,field:"date",header:"GRN Date",sortable:!0,filter:!0,style:{minWidth:"8rem"}}),r.createElement(k.s,{headerStyle:q.iR,field:"project.name",header:"Project",sortable:!0,filter:!0,style:{minWidth:"8rem"}}),r.createElement(k.s,{headerStyle:q.iR,field:"vendor.name",header:"Vendor",sortable:!0,filter:!0,style:{minWidth:"12rem"}}),r.createElement(k.s,{headerStyle:q.iR,field:"vendtyp_key",header:"Vendor RefNo",sortable:!0,filter:!0,style:{minWidth:"8rem"}}),r.createElement(k.s,{headerStyle:q.iR,field:"docstatus",header:"GRN Status",sortable:!0,filter:!0,style:{minWidth:"8rem"}}))},W=function(e){return r.createElement(a.AW,{path:E},r.createElement(a.AW,{path:"new",element:r.createElement(x,{moduleName:e})}),r.createElement(a.AW,{path:":id/edit",element:r.createElement(x,{moduleName:e})}),r.createElement(a.AW,{index:!0,element:r.createElement(C,{moduleName:e})}))}}}]);
//# sourceMappingURL=798.d066f168.chunk.js.map