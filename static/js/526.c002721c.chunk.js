"use strict";(self.webpackChunkbuild_iq_app=self.webpackChunkbuild_iq_app||[]).push([[526],{8526:function(e,t,n){n.r(t),n.d(t,{default:function(){return Y}});var r,a,o=n(969),i=n(734),l=n(7039),c=n(4732),s="users",u="User",d=[{items:[{label:"User",icon:"pi ml-3",template:(r=s,(0,l.E7)("/".concat(c.o,"/").concat(r)+(a?"/comming-soon":""))),altUrls:"/users/roles"}]}],p=n(2723),m=n(6234),f=n(3953),v=n(7765),g=n(8224),y=n(8391),h=n(8079),E=n(1495),b=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},S="/user/",x=E.rj.injectEndpoints({overrideExisting:!1,endpoints:function(e){return{listUser:e.query({query:function(e){var t=e.page,n=e.size;return{url:"".concat(S,"?page=").concat(t||1,"&page_size=").concat(n||E.IV)}},providesTags:function(e){return e?[].concat((0,h.Z)(null===e||void 0===e?void 0:e.map((function(e){var t=e.id;return{type:E.pJ.USER,id:t}}))),[{type:E.pJ.USER,id:"LIST"}]):[{type:E.pJ.USER,id:"LIST"}]}}),addUser:e.mutation({query:function(e){return{url:S,method:"POST",body:e}},invalidatesTags:[{type:E.pJ.USER,id:"LIST"}]}),getUser:e.query({query:function(e){return"".concat(S).concat(e)},providesTags:function(e,t,n){return[{type:E.pJ.USER,id:n}]}}),updateUser:e.mutation({query:function(e){var t=e.id,n=b(e,["id"]);return{url:"".concat(S).concat(t),method:"PUT",body:n}},invalidatesTags:function(e){return[{type:E.pJ.USER,id:null===e||void 0===e?void 0:e.id}]}}),deleteUser:e.mutation({query:function(e){return{url:"".concat(S).concat(e),method:"DELETE"}},invalidatesTags:function(e){return[{type:E.pJ.USER,id:null===e||void 0===e?void 0:e.id}]}}),getErrorProne:e.query({query:function(){return"error-prone"}})}}}),w=x.useAddUserMutation,P=x.useDeleteUserMutation,T=x.useGetUserQuery,I=x.useListUserQuery,O=x.useUpdateUserMutation,N=(x.useGetErrorProneQuery,function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}),k="/role/",L=E.rj.injectEndpoints({overrideExisting:!1,endpoints:function(e){return{getRoles:e.query({query:function(){return{url:(0,E.DS)(k)}},providesTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat((0,h.Z)(e.map((function(e){var t=e.key;return{type:E.pJ.CITIES,id:t}}))),[{type:E.pJ.CITIES,id:"LIST"}])}}),addRole:e.mutation({query:function(e){return{url:k,method:"POST",body:e}},invalidatesTags:[{type:E.pJ.CITIES,id:"LIST"}]}),getRole:e.query({query:function(e){return"".concat(k).concat(e)},providesTags:function(e,t,n){return[{type:E.pJ.CITIES,id:n}]}}),updateRole:e.mutation({query:function(e){var t=e.key,n=N(e,["key"]);return{url:"".concat(k).concat(t),method:"PUT",body:n}},invalidatesTags:function(e){return[{type:E.pJ.CITIES,id:null===e||void 0===e?void 0:e.id}]}}),deleteRole:e.mutation({query:function(e){return{url:"".concat(k).concat(e),method:"DELETE"}},invalidatesTags:function(e){return[{type:E.pJ.CITIES,id:null===e||void 0===e?void 0:e.id}]}}),getPermissions:e.query({query:function(){return{url:(0,E.DS)("/permission/")}},providesTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat((0,h.Z)(e.map((function(e){var t=e.key;return{type:E.pJ.CITIES,id:t}}))),[{type:E.pJ.CITIES,id:"LIST"}])}}),getErrorProne:e.query({query:function(){return"error-prone"}})}}}),R=L.useAddRoleMutation,j=L.useDeleteRoleMutation,q=(L.useGetRoleQuery,L.useGetRolesQuery),_=L.useUpdateRoleMutation,U=(L.useGetErrorProneQuery,L.useGetPermissionsQuery),Z=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(t){o(t)}}function l(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},A=function(e){var t=(0,l.pm)(),n=t.showSuccess,r=t.showError,a=(0,o.useState)(!1),d=(0,m.Z)(a,2),h=d[0],b=d[1],S=(0,i.s0)(),x=(0,i.UO)().id,P=parseInt(x||""),I=isNaN(P)||P<=0,N=(0,E.ft)(),k=q(),L=k.data,R=(k.isLoading,T(P,{skip:I})),j=R.data,_=R.isLoading,U=(0,o.useState)(null),A=(0,m.Z)(U,2),C=A[0],W=A[1],J=w(),D=(0,m.Z)(J,2),F=D[0],z=D[1].isLoading,G=O(),V=(0,m.Z)(G,2),Q=V[0],M=V[1].isLoading;(0,o.useEffect)((function(){var e;j&&W(Object.assign(Object.assign({},j),{role:(null===(e=null===j||void 0===j?void 0:j.role[0])||void 0===e?void 0:e.id)||""}))}),[j]);return o.createElement(o.Fragment,null,o.createElement(l.Rm,{baseRoute:"/".concat(c.o,"/").concat(s),description:u,id:P,data:C,isUpdating:z||M||h,isLoading:_,onSubmit:function(e){return Z(void 0,void 0,void 0,(0,p.Z)().mark((function t(){var a,o;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!I){t.next=7;break}return t.next=4,F(Object.assign(Object.assign({},e),N)).unwrap();case 4:o=t.sent,t.next=10;break;case 7:return t.next=9,Q(Object.assign(Object.assign({},e),N)).unwrap();case 9:o=t.sent;case 10:n("Success",o.detail),b(!0),setTimeout((function(){S("/".concat(c.o,"/").concat(s))}),E.P7),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),r("An error occurred",(null===(a=null===t.t0||void 0===t.t0?void 0:t.t0.data)||void 0===a?void 0:a.detail)||"We couldn't save your post, try again!");case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))},renderForm:function(e,t,n,r){return o.createElement("div",{className:"pl-8"},o.createElement(l.Wi,{label:"User Name",name:"user_name",control:e,errors:n,required:!0,leftSpan:2,rightSpan:5,formItem:{component:v.o,componentProps:{maxLength:100}}}),o.createElement(l.Wi,{label:"First Name",name:"first_name",control:e,errors:n,leftSpan:2,rightSpan:4,required:!0,formItem:{component:v.o,componentProps:{maxLength:100}}}),o.createElement(l.Wi,{label:"Last Name",name:"last_name",control:e,errors:n,leftSpan:2,rightSpan:4,formItem:{component:v.o,componentProps:{maxLength:100}}}),o.createElement(l.Wi,{label:"Phone Number",name:"phone_number",required:!0,control:e,errors:n,leftSpan:2,rightSpan:4,formItem:{component:v.o,componentProps:{maxLength:100}}}),o.createElement(l.Wi,{label:"Email",name:"email",required:!0,control:e,errors:n,leftSpan:2,rightSpan:6,formItem:{component:v.o,componentProps:{maxLength:100}}}),o.createElement("div",{className:"field"},o.createElement("label",{style:{margin:"auto",paddingLeft:0},htmlFor:"is_active",className:"col-2"},"Is Active?"),o.createElement(f.Qr,{defaultValue:!1,name:"is_active",control:e,render:function(e){var t=e.field;e.fieldState;return o.createElement(y.X,Object.assign({checked:t.value,trueValue:!0,falseValue:!1,id:t.name},t))}})),o.createElement(l.Wi,{label:"Role",name:"role",control:e,errors:n,required:!0,leftSpan:2,rightSpan:4,useExplicit:!0,formItem:{component:g.L,componentProps:{optionGroupTemplate:o.createElement("div",{style:{cursor:"pointer",textAlign:"center",backgroundColor:"#e6e1e1",color:"black",lineHeight:2.5},onClick:function(){return S("/users/roles",{state:{url:I?"/users/users/new":"/users/users/".concat(null===C||void 0===C?void 0:C.id,"/edit"),data:r()}})}},"-- Create And Edit --"),optionLabel:"role",optionValue:"id",optionGroupLabel:"label",optionGroupChildren:"items",options:[{label:"Add",items:L||[]}]}}}))}}))},C=function(e){var t=(0,o.useState)(1),n=(0,m.Z)(t,2),r=n[0],a=(n[1],(0,o.useState)(E.IV)),i=(0,m.Z)(a,2),d=i[0],p=(i[1],I({page:r,size:d})),f=p.data,v=p.isFetching,g=P(),y=(0,m.Z)(g,2),h=y[0],b=y[1].isLoading;return o.createElement(l.PS,{baseRoute:"/".concat(c.o,"/").concat(s),description:u,isLoading:v||b,data:f,deleteAction:function(e){return h(e).unwrap()},newTable:!0,showHeader:!0,navKey:"id",delKey:"id"},o.createElement(l._P,{field:"id",header:"User Code",filteringType:"number"}),o.createElement(l._P,{field:"user_name",header:"User Name",filteringType:"text"}),o.createElement(l._P,{field:"first_name",header:"First Name",filteringType:"text"}),o.createElement(l._P,{field:"phone_number",header:"Phone Number",filteringType:"text"}),o.createElement(l._P,{field:"email",header:"Email",filteringType:"text"}))},W=o.createElement(i.AW,{path:s},o.createElement(i.AW,{path:"new",element:o.createElement(A,null)}),o.createElement(i.AW,{path:":id/edit",element:o.createElement(A,null)}),o.createElement(i.AW,{index:!0,element:o.createElement(C,null)})),J=n(4401),D=n(6272),F=n(8356),z=n(6770),G=n(8103),V=n(4576),Q=n(1387),M=n(4756),K=n(7624),H=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(t){o(t)}}function l(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},B=function(){var e=(0,i.s0)(),t=(0,i.TH)().state,n=(0,E.ft)(),r=(0,f.cI)({}),a=r.control,c=r.formState,s=c.errors,u=(c.isDirty,r.register,r.reset,r.handleSubmit),d=r.setValue,g=q(),y=g.data,h=g.isLoading,b=U(),S=b.data,x=(b.isLoading,(0,o.useState)([])),w=(0,m.Z)(x,2),P=w[0],T=w[1],I=(0,o.useState)(!0),O=(0,m.Z)(I,2),N=O[0],k=O[1],L=(0,o.useState)(null),Z=(0,m.Z)(L,2),A=Z[0],C=Z[1],W=(0,o.useRef)(null),B=(0,o.useState)(!1),X=(0,m.Z)(B,2),Y=(X[0],X[1],R()),$=(0,m.Z)(Y,2),ee=$[0],te=$[1].isLoading,ne=_(),re=(0,m.Z)(ne,2),ae=re[0],oe=re[1].isLoading,ie=j(),le=(0,m.Z)(ie,2),ce=le[0],se=(le[1].isLoading,function(e){return ce(e).unwrap()}),ue=function(e,t){var n;null===(n=null===W||void 0===W?void 0:W.current)||void 0===n||n.show({severity:"success",summary:e,detail:t,life:3e3})},de=function(e,t){var n;null===(n=null===W||void 0===W?void 0:W.current)||void 0===n||n.show({severity:"error",summary:e,detail:t,life:3e3})};return h?o.createElement("div",{className:"custom-skeleton p-4"},o.createElement("div",null,o.createElement(D.O,{height:"50px",width:"30%",className:"mb-2"}),o.createElement(D.O,{height:"50px",width:"50%",className:"mb-2"}))):o.createElement(o.Fragment,null,o.createElement(Q.F,{ref:W}),o.createElement(l.Gn,{className:"pl-8",style:{height:"50%",width:"90%"},header:o.createElement("div",{className:"flex"},o.createElement("h3",{className:(0,M.AK)("m-0 my-auto")},"Role")),rowHover:!0,onRowClick:function(e){k(!1),C(e.data.id),d("role",e.data.role),d("role_description",e.data.role_description),T(null===S||void 0===S?void 0:S.filter((function(t){var n,r;return(null===(r=null===(n=e.data)||void 0===n?void 0:n.access)||void 0===r?void 0:r.filter((function(e){return e.id===t.id})).length)>0})))},value:y,stripedRows:!0},o.createElement(J.s,{headerStyle:K.jc,style:{maxWidth:"80px"},bodyStyle:{textAlign:"center",overflow:"visible"},body:function(e){return function(t){return o.createElement(o.Fragment,null,o.createElement(z.z,{onClick:function(){console.log(t),k(!1),C(t.id),d("role",t.role),d("role_description",t.role_description),T(null===S||void 0===S?void 0:S.filter((function(e){return[1,2].includes(e.id)})))},icon:"pi pi-eye",className:"p-button-rounded p-button-text"}),o.createElement(z.z,{style:{height:"20px",width:"20px",borderRadius:50},onClick:function(){return e(t.id)},className:"p-button-rounded p-button-text",icon:"pi pi-trash"}))}}((function(e){return H(void 0,void 0,void 0,(0,p.Z)().mark((function t(){return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(se){t.next=2;break}return t.abrupt("return");case 2:(0,V.V)({message:"Are you sure you want to delete?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:function(){return H(void 0,void 0,void 0,(0,p.Z)().mark((function t(){var n,r;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,se(e);case 3:r=t.sent,ue("Success",r),k(!0),C(null),d("role",""),d("role_description",""),T([]),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),de("Failed",null===(n=null===t.t0||void 0===t.t0?void 0:t.t0.data)||void 0===n?void 0:n.detail);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))},reject:function(){}});case 3:case"end":return t.stop()}}),t)})))}))}),o.createElement(J.s,{headerStyle:K.iR,style:{maxWidth:"200px"},field:"role",header:"Role Name",sortable:!0,filter:!0}),o.createElement(J.s,{headerStyle:K.iR,field:"access_pages",header:"Accessible Pages",body:function(e){return null===e||void 0===e?void 0:e.access.map((function(e){return e.name})).join(",")}})),o.createElement(F.i,null),o.createElement("form",{onSubmit:u((function(e){return H(void 0,void 0,void 0,(0,p.Z)().mark((function t(){var r,a;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=Object.assign(Object.assign({},e),{access:null===P||void 0===P?void 0:P.map((function(e){return e.id}))}),console.log(a),!N){t.next=9;break}return t.next=6,ee(Object.assign(Object.assign({},a),n)).unwrap();case 6:r=t.sent,t.next=13;break;case 9:return console.log(A),t.next=12,ae(Object.assign(Object.assign({key:A},a),n)).unwrap();case 12:r=t.sent;case 13:k(!0),C(null),d("role",""),d("role_description",""),T([]),ue("Success",r.detail),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(0),de("An error occurred","We couldn't save your request, try again!");case 24:case"end":return t.stop()}}),t,null,[[0,21]])})))}))},o.createElement("div",{className:"flex"},o.createElement("div",{className:"col-1"}),o.createElement("div",{className:"col-7"},function(e,t,n){return o.createElement("div",{className:"pl-8"},o.createElement(l.Wi,{label:"Role Name",name:"role",control:e,errors:n,required:!0,leftSpan:4,rightSpan:5,formItem:{component:v.o,componentProps:{maxLength:50,disabled:te||oe}}}),o.createElement(l.Wi,{label:"Description",name:"role_description",control:e,errors:n,required:!0,leftSpan:4,rightSpan:5,formItem:{component:v.o,componentProps:{maxLength:50,disabled:te||oe}}}),o.createElement(l.Wi,{label:"Accessible Pages",name:"access",control:e,errors:n,leftSpan:4,rightSpan:5,formItem:{component:G.N,componentProps:{value:P,optionLabel:"permission",onChange:function(e){return T(e.value)},options:S,display:"chip",placeholder:"Select Pages",className:"w-full md:w-20rem"}}}))}(a,0,s)),o.createElement("div",{className:"my-auto"},o.createElement(z.z,{loading:te||oe,label:"Save",id:"submit",type:"submit",style:{paddingRight:20},className:"p-button-warning mr-3"}),o.createElement(z.z,{loading:te||oe,label:"Clear",style:{paddingRight:20},className:"p-button-warning mr-3",onClick:function(e){return H(void 0,void 0,void 0,(0,p.Z)().mark((function t(){return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),k(!0),C(null),d("role",""),d("role_description",""),T([]);case 6:case"end":return t.stop()}}),t)})))}}),o.createElement(z.z,{loading:te||oe,label:"Back",onClick:function(){return e((null===t||void 0===t?void 0:t.url)||"/users/users",{state:t.data})}})))))},X=o.createElement(i.AW,{path:"roles"},o.createElement(i.AW,{index:!0,element:o.createElement(B,null)})),Y=function(){return o.createElement(i.Z5,null,o.createElement(i.AW,{path:"/",element:o.createElement(l.SV,{navItems:d})},o.createElement(i.AW,{index:!0,element:o.createElement(i.Fg,{to:s,replace:!0})}),W,X,o.createElement(i.AW,{path:":page/comming-soon",element:o.createElement(l.hg,null)}),o.createElement(i.AW,{path:"*",element:o.createElement(l.EN,{relative:!0})})))}},8356:function(e,t,n){n.d(t,{i:function(){return i}});var r=n(969),a=n(4756);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}var i=r.forwardRef((function(e,t){var n="horizontal"===e.layout,l="vertical"===e.layout,c=a.gb.findDiffKeys(e,i.defaultProps),s=(0,a.AK)("p-divider p-component p-divider-".concat(e.layout," p-divider-").concat(e.type),{"p-divider-left":n&&(!e.align||"left"===e.align),"p-divider-right":n&&"right"===e.align,"p-divider-center":n&&"center"===e.align||l&&(!e.align||"center"===e.align),"p-divider-top":l&&"top"===e.align,"p-divider-bottom":l&&"bottom"===e.align},e.className);return r.createElement("div",o({className:s,style:e.style,role:"separator"},c),r.createElement("div",{className:"p-divider-content"},e.children))}));i.displayName="Divider",i.defaultProps={__TYPE:"Divider",align:null,layout:"horizontal",type:"solid",style:null,className:null}}}]);
//# sourceMappingURL=526.c002721c.chunk.js.map